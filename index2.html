<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <title>Store Halfword Byte-Reverse Indexed</title>
  <meta name="author" content="OzLabs">

  <link href="https://sthbrx.github.io/rss.xml" type="application/rss+xml" rel="alternate"
        title="Store Halfword Byte-Reverse Indexed RSS Feed" />



  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="https://sthbrx.github.io/favicon.png" rel="icon">

  <link href="https://sthbrx.github.io/theme/css/main.css" media="screen, projection"
        rel="stylesheet" type="text/css">

  <link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic"
        rel="stylesheet" type="text/css">

  <script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
  var ts = document.createElement('span')
  ts.className = 'toggle-sidebar'
  ts = document.getElementById('content').appendChild(ts);
  ts.addEventListener('click', function(e) {
    e.preventDefault();
    body = document.getElementsByTagName('body')[0];
    bodyClasses = body.classList.toggle('collapse-sidebar');
  });
  var sections = document.querySelectorAll('aside.sidebar > section');
  if (sections.length > 1) {
    for (index = 0; index < sections.length; index++) {
      section = sections[index];
      if ((sections.length >= 3) && index % 3 === 0) {
        section.classList.add("first");
      }
      var count = ((index +1) % 2) ? "odd" : "even";
      section.classList.add(count);
    }
  }
  if (sections.length >= 3) {
    document.querySelector('aside.sidebar').classList.add('thirds');
  }
});
  </script>
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-91189608-1', 'auto');

    ga('send', 'pageview');
    </script>
</head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="https://sthbrx.github.io/">Store Halfword Byte-Reverse Indexed</a></h1>
    <h2>A Power Technical Blog</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="https://sthbrx.github.io/rss.xml" rel="subscribe-rss">RSS</a></li>
</ul>


<ul class="main-navigation">
      <li >
        <a href="https://sthbrx.github.io/category/development.html">Development</a>
      </li>
      <li >
        <a href="https://sthbrx.github.io/category/education.html">Education</a>
      </li>
      <li >
        <a href="https://sthbrx.github.io/category/openpower.html">OpenPOWER</a>
      </li>
      <li >
        <a href="https://sthbrx.github.io/category/performance.html">Performance</a>
      </li>
      <li >
        <a href="https://sthbrx.github.io/category/petitboot.html">Petitboot</a>
      </li>
      <li >
        <a href="https://sthbrx.github.io/category/snowpatch.html">snowpatch</a>
      </li>
      <li >
        <a href="https://sthbrx.github.io/category/virtualisation-and-emulation.html">Virtualisation and Emulation</a>
      </li>
</ul></nav>
  <div id="main">
    <div id="content">
<div class="blog-index">
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://sthbrx.github.io/blog/2021/06/14/fuzzing-grub-part-2-going-faster/">Fuzzing grub, part 2: going faster</a>
      </h1>
    <p class="meta">
<time datetime="2021-06-14T17:10:00+10:00" pubdate>Mon 14 June 2021</time>    </p>
</header>

<div class="byline_index">
  <span class="byline author vcard">
    Posted by <span class="fn">
          <a href="https://sthbrx.github.io/author/daniel-axtens.html">Daniel Axtens</a>
    </span>
  </span>
<time datetime="2021-06-14T17:10:00+10:00" pubdate>Mon 14 June 2021</time></div>

  <div class="entry-content"><p>Recently a set of 8 vulnerabilities were disclosed for the <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/GRUB2SecureBootBypass2021">grub bootloader</a>. I
found 2 of them (CVE-2021-20225 and CVE-2021-20233), and contributed a number of
other fixes for crashing bugs which we don't believe are exploitable. I found
them by applying fuzz testing to grub. Here's how.</p>
<p>This is a multi-part series: I think it will end up being 4 posts. I'm hoping to
cover:</p>
<ul>
<li><a href="/blog/2021/03/04/fuzzing-grub-part-1">Part 1: getting started with fuzzing grub</a></li>
<li>Part 2 (this post): going faster by doing lots more work</li>
<li>Part 3: fuzzing filesystems and more</li>
<li>Part 4: potential next steps and avenues for further work</li>
</ul>
<p>We've been looking at fuzzing <code>grub-emu</code>, which is basically most parts of grub
built into a standard userspace program. This includes all the script parsing
logic, fonts, graphics, partition tables, filesystems and so on - just not
platform specific driver code or the ability to actually load and boot a kernel.</p>
<p>Previously, we talked about some issues building grub with AFL++'s
instrumentation:</p>
<div class="highlight"><pre><span></span><code>:::<span class="nv">text</span><span class="w"></span>
.<span class="o">/</span><span class="nv">configure</span><span class="w"> </span><span class="o">--</span><span class="nv">with</span><span class="o">-</span><span class="nv">platform</span><span class="o">=</span><span class="nv">emu</span><span class="w"> </span><span class="o">--</span><span class="nv">disable</span><span class="o">-</span><span class="nv">grub</span><span class="o">-</span><span class="nv">emu</span><span class="o">-</span><span class="nv">sdl</span><span class="w"> </span><span class="nv">CC</span><span class="o">=</span><span class="mh">$AF</span><span class="nv">L_PATH</span><span class="o">/</span><span class="nv">afl</span><span class="o">-</span><span class="nv">cc</span><span class="w"></span>
...<span class="w"></span>
<span class="nv">checking</span><span class="w"> </span><span class="nv">whether</span><span class="w"> </span><span class="nv">target</span><span class="w"> </span><span class="nv">compiler</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">working</span>...<span class="w"> </span><span class="nv">no</span><span class="w"></span>
<span class="nv">configure</span>:<span class="w"> </span><span class="nv">error</span>:<span class="w"> </span><span class="nv">cannot</span><span class="w"> </span><span class="nv">compile</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">target</span><span class="w"></span>
</code></pre></div>

<p>It also doesn't work with <code>afl-gcc</code>.</p>
<p>We tried to trick configure:</p>
<div class="highlight"><pre><span></span><code>:::shell
./configure --with-platform=emu --disable-grub-emu-sdl CC=clang CXX=clang++
make CC=&quot;$AFL_PATH/afl-cc&quot; 
</code></pre></div>

<p>Sadly, things still break:</p>
<div class="highlight"><pre><span></span><code><span class="o">:::</span><span class="n">text</span><span class="w"></span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="nl">ld:</span><span class="w"> </span><span class="n">disk</span><span class="p">.</span><span class="k">module</span><span class="o">:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">x20</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">definition</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="no">`__afl_global_area_ptr</span><span class="p">&#39;;</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="nl">exec:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">xe078</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">here</span><span class="w"></span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="nl">ld:</span><span class="w"> </span><span class="n">regexp</span><span class="p">.</span><span class="k">module</span><span class="o">:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">x70</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">definition</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="no">`__afl_global_area_ptr</span><span class="p">&#39;;</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="nl">exec:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">xe078</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">here</span><span class="w"></span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="nl">ld:</span><span class="w"> </span><span class="n">blocklist</span><span class="p">.</span><span class="k">module</span><span class="o">:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">x28</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">definition</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="no">`__afl_global_area_ptr</span><span class="p">&#39;;</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="nl">exec:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">xe078</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">here</span><span class="w"></span>
</code></pre></div>

<p>The problem is the module linkage that I talked about in <a href="/blog/2021/03/04/fuzzing-grub-part-1">part 1</a>.
There is a link stage of sorts for the kernel (<code>kernel.exec</code>) and each module
(e.g. <code>disk.module</code>), so some AFL support code gets linked into each of
those. Then there's another link stage for <code>grub-emu</code> itself, which also tries
to bring in the same support code. The linker doesn't like the symbols being in
multiple places, which is fair enough.</p>
<p>There are (at least) 3 ways you could solve this. I'm going to call them the hard way, and the ugly way and the easy way.</p>
<h2>The hard way: messing with makefiles</h2>
<p>We've been looking at fuzzing <code>grub-emu</code>. Building <code>grub-emu</code> links
<code>kernel.exec</code> and almost every <code>.module</code> file that grub produces into the
final binary. Maybe we could avoid our duplicate symbol problems entirely by
changing how we build things?</p>
<p>I didn't do this in my early work because, to be honest, I don't like working
with build systems and I'm not especially good at it. grub's build system is
based on autotools but is even more quirky than usual: rather than just having a
<code>Makefile.am</code>, we have <code>Makefile.core.def</code> which is used along with other things
to generate <code>Makefile.am</code>. It's a pretty cool system for making modules, but
it's not my idea of fun to work with.</p>
<p>But, for the sake of completeness, I tried again.</p>
<p>It gets unpleasant quickly. The generated <code>grub-core/Makefile.core.am</code> adds each module to <code>platform_PROGRAMS</code>, and then each is built with <code>LDFLAGS_MODULE = $(LDFLAGS_PLATFORM) -nostdlib $(TARGET_LDFLAGS_OLDMAGIC) -Wl,-r,-d</code>.</p>
<p>Basically, in the makefile this ends up being (e.g.):</p>
<div class="highlight"><pre><span></span><code><span class="err">:::make</span><span class="w"></span>
<span class="nf">tar.module$(EXEEXT)</span><span class="o">:</span> <span class="k">$(</span><span class="nv">tar_module_OBJECTS</span><span class="k">)</span> <span class="k">$(</span><span class="nv">tar_module_DEPENDENCIES</span><span class="k">)</span> <span class="k">$(</span><span class="nv">EXTRA_tar_module_DEPENDENCIES</span><span class="k">)</span> 
    @rm -f tar.module<span class="k">$(</span>EXEEXT<span class="k">)</span>
    <span class="k">$(</span>AM_V_CCLD<span class="k">)$(</span>tar_module_LINK<span class="k">)</span> <span class="k">$(</span>tar_module_OBJECTS<span class="k">)</span> <span class="k">$(</span>tar_module_LDADD<span class="k">)</span> <span class="k">$(</span>LIBS<span class="k">)</span>
</code></pre></div>

<p>Ideally I don't want them to be linked at all; there's no benefit if
they're just going to be linked again.</p>
<p>You can't just collect the sources and build them into <code>grub-emu</code> - they all
have to built with different <code>CFLAGS</code>! So instead I spent some hours messing
around with the build system. Given some changes to the python script that
converts the <code>Makefile.*.def</code> files into <code>Makefile.am</code> files, plus some other
bits and pieces, we can build <code>grub-emu</code> by linking the object files rather than
the more-processed modules.</p>
<p>The build dies immediately after linking <code>grub-emu</code> in other components, and it
requires a bit of manual intervention to get the right things built in the right
order, but with all of those caveats, it's enough. It works, and you can turn on
things like ASAN, but getting there was hard, unrewarding and unpleasant. Let's
consider alternative ways to solve this problem.</p>
<h2>The ugly way: patching AFL</h2>
<p>What I did when finding the bugs was to observe that we only wanted AFL to link
in its extra instrumentation at certain points of the build process. So I
patched AFL to add an environment variable <code>AFL_DEFER_LIB</code> - which prevented AFL
adding its own instrumentation library when being called as a linker. I combined
this with the older CFG instrumentation, as the PCGUARD instrumentation brought
in a bunch of symbols from LLVM which I didn't want to also figure out how to
guard.</p>
<p>I then wrapped this in a horrifying script that basically built bits and pieces
of grub with the environment variable on or off, in order to at least get the
userspace tools and <code>grub-emu</code> built. Basically it set <code>AFL_DEFER_LIB</code> when
building all the modules and turned it off when building the userspace tools
and <code>grub-emu</code>.</p>
<p>This worked and it's what I used to find most of my bugs. But I'd probably not
recommend it, and I'm not sharing the source: it's extremely fragile and
brittle, the hard way is more generally applicable, and the easy way is nicer.</p>
<h2>The easy way: adjusting linker flags</h2>
<p>After posting part 1 of this series, I had a fascinating twitter DM conversation
with <a href="https://twitter.com/hackerschoice">@hackerschoice</a>, who pointed me to some
new work that had been done in AFL++ between when I started and when I published
part 1.</p>
<p>AFL++ now has the ability to dynamically detect some duplicate symbols, allowing
it to support plugins and modules better. This isn't directly applicable because
we link all the modules in at build time, but in the conversation I was pointed
to a linker flag which instructs the linker to ignore the symbol duplication
rather than error out. This provides a significantly simpler way to instrument
<code>grub-emu</code>, avoiding all the issues I'd previously been fighting so hard to
address.</p>
<p>So, with a modern AFL++, and the patch from <a href="https://github.com/daxtens/grub/tree/fuzzing-pt2">part 1</a>,
you can sort out this entire process like this:</p>
<div class="highlight"><pre><span></span><code>:::shell
./bootstrap
./configure --with-platform=emu CC=clang CXX=clang++ --disable-grub-emu-sdl
make CC=/path/to/afl-clang-fast LDFLAGS=&quot;-Wl,--allow-multiple-definition&quot;
</code></pre></div>

<p>Eventually it will error out, but <code>./grub-core/grub-emu</code> should be successfully
built first.</p>
<p>(Why not just build <code>grub-emu</code> directly? It gets built by <code>grub-core/Makefile</code>,
but depends on a bunch of things made by the top-level makefile and doesn't
express its dependencies well. So you can try to build all the things that you
need separately and then <code>cd grub-core; make ...flags... grub-emu</code> if you want -
but it's way more complicated to do it that way!)</p>
<h1>Going extra fast: <code>__AFL_INIT</code></h1>
<p>Now that we can compile with instrumentation, we can use <code>__AFL_INIT</code>. I'll
leave the precise details of how this works to the AFL docs, but in short it
allows us to do a bunch of early setup only once, and just fork the process
after the setup is done.</p>
<p>There's a patch that inserts a call to <code>__AFL_INIT</code> in the <code>grub-emu</code> start path
in <a href="https://github.com/daxtens/grub/tree/fuzzing-pt2">my GitHub repo</a>.</p>
<p>All up, this can lead to a 2x-3x speedup over the figures I saw in <a href="/blog/2021/03/04/fuzzing-grub-part-1">part 1</a>.
In part 1 we saw around 244 executions per second at this point - now we're over
500:</p>
<p><img alt="afl-fuzz fuzzing grub, showing fuzzing happening" src="/images/dja/grub-fuzzing-pt2.png"></p>
<h1>Finding more bugs with sanitisers</h1>
<p>A 'sanitizer' refers to a set of checks inserted by a compiler at build time to
detect various runtime issues that might not cause a crash or otherwise be
detected. A particularly common and useful sanitizer is ASAN, the
<a href="https://clang.llvm.org/docs/AddressSanitizer.html">AddressSanitizer</a>, which
detects out-of-bounds memory accesses, use-after-frees and other assorted memory
bugs. Other sanitisers can check for
<a href="https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html">undefined behaviour</a>,
<a href="https://clang.llvm.org/docs/MemorySanitizer.html">uninitialised memory reads</a>
or even breaches of
<a href="https://releases.llvm.org/12.0.0/tools/clang/docs/ControlFlowIntegrity.html">control flow integrity</a>.</p>
<p>ASAN is particularly popular for fuzzing. In theory, compiling with AFL++ and
LLVM makes it really easy to compile with ASAN. Setting <code>AFL_USE_ASAN=1</code> should
be sufficient.</p>
<p>However, in practice, it's quite fragile for grub. I believe I had it all
working, and then I upgraded my distro, LLVM and AFL++ versions, and everything
stopped working. (It's possible that I hadn't sufficiently cleaned my source
tree and I was still building based on the hard way? Who knows.)</p>
<p>I spent quite a while fighting "truncated relocations". ASAN instrumentation was
bloating the binaries, and the size of all the <code>*.module</code> files was over 512MB,
which I suspect was causing the issues. (Without ASAN, it only comes to 35MB.)</p>
<p>I tried <code>afl-clang-lto</code>: I installed <code>lld</code>, rebuilt AFL++, and managed to
segfault the linker while building grub. So I wrote that off. Changing the
instrumentation type to classic didn't help either.</p>
<p><a href="https://www.technovelty.org/c/relocation-truncated-to-fit-wtf.html">Some googling</a>
suggested GCC's <code>-mmodel</code>, which in Clang seems to be <code>-mcmodel</code>, but
<code>CFLAGS="-mcmodel=large"</code> didn't get me any further either: it's already added
in a few different links.</p>
<p>My default llvm is llvm-12, so I tried building with llvm-9 and llvm-11 in case
that helped. Both built a binary, but it would fail to start:</p>
<div class="highlight"><pre><span></span><code><span class="p">:::</span><span class="n">text</span><span class="w"></span>
<span class="o">==</span><span class="mi">375638</span><span class="o">==</span><span class="n">AddressSanitizer</span><span class="w"> </span><span class="n">CHECK</span><span class="w"> </span><span class="n">failed</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">toolchain</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="mi">8</span><span class="n">fovFY</span><span class="o">/</span><span class="n">llvm</span><span class="o">-</span><span class="n">toolchain</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="mf">9.0</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">compiler</span><span class="o">-</span><span class="n">rt</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">sanitizer_common</span><span class="o">/</span><span class="n">sanitizer_common_libcdep</span><span class="o">.</span><span class="n">cc</span><span class="p">:</span><span class="mi">23</span><span class="w"> </span><span class="s2">&quot;((SoftRssLimitExceededCallback)) == ((nullptr))&quot;</span><span class="w"> </span><span class="p">(</span><span class="mh">0x423660</span><span class="p">,</span><span class="w"> </span><span class="mh">0x0</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

<p>The same happens if I build with llvm-12 and <code>afl-clang</code>, the old-style
instrumentation.</p>
<p>I spun up a Ubuntu 20.04 VM and build there with LLVM 10 and the latest stable
AFL++. That didn't work either.</p>
<p>I had much better luck using GCC's and GCC's ASAN implementation, either with
the old-school <code>afl-gcc</code> or the newer GCC plugin-based <code>afl-gcc-fast</code>. (I have
some hypotheses around shared library vs static library ASAN, but having spent
way more work time on this than was reasonable, I was disinclined to debug it
further.) Here's what worked for me:</p>
<div class="highlight"><pre><span></span><code><span class="p">:::</span><span class="n">shell</span><span class="w"></span>
<span class="o">./</span><span class="n">configure</span><span class="w"> </span><span class="o">--</span><span class="n">with</span><span class="o">-</span><span class="n">platform</span><span class="o">=</span><span class="n">emu</span><span class="w"> </span><span class="o">--</span><span class="n">disable</span><span class="o">-</span><span class="n">grub</span><span class="o">-</span><span class="n">emu</span><span class="o">-</span><span class="n">sdl</span><span class="w"></span>
<span class="c1"># the ASAN option is required because one of the tools leaks memory and</span><span class="w"></span>
<span class="c1"># that breaks the generation of documentation.</span><span class="w"></span>
<span class="c1"># -Wno-nested-extern makes __AFL_INIT work on gcc</span><span class="w"></span>
<span class="n">ASAN_OPTIONS</span><span class="o">=</span><span class="n">detect_leaks</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">AFL_USE_ASAN</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">CC</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">afl</span><span class="o">-</span><span class="n">gcc</span><span class="o">-</span><span class="n">fast</span><span class="w"> </span><span class="n">LDFLAGS</span><span class="o">=</span><span class="s2">&quot;-Wl,--allow-multiple-definition&quot;</span><span class="w"> </span><span class="n">CFLAGS</span><span class="o">=</span><span class="s2">&quot;-Wno-nested-extern&quot;</span><span class="w"></span>
</code></pre></div>

<p>GCC doesn't support as many sanitisers as LLVM, but happily it does support
ASAN. AFL++'s GCC plugin mode should get us most of the speed we would get from
LLVM, and indeed the speed - even with ASAN - is quite acceptable.</p>
<p>If you persist, you should be able to find some more bugs: for example there's a
very boring global array out-of-bounds read when parsing config files.</p>
<p>That's all for part 2. In part 3 we'll look at fuzzing filesystems and
more. Hopefully there will be a quicker turnaround between part 2 and part 3
than there was between part 1 and part 2!</p></div>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://sthbrx.github.io/blog/2021/03/04/fuzzing-grub-part-1/">Fuzzing grub: part 1</a>
      </h1>
    <p class="meta">
<time datetime="2021-03-04T17:10:00+11:00" pubdate>Thu 04 March 2021</time>    </p>
</header>

<div class="byline_index">
  <span class="byline author vcard">
    Posted by <span class="fn">
          <a href="https://sthbrx.github.io/author/daniel-axtens.html">Daniel Axtens</a>
    </span>
  </span>
<time datetime="2021-03-04T17:10:00+11:00" pubdate>Thu 04 March 2021</time></div>

  <div class="entry-content"><p>Recently a set of 8 vulnerabilities were disclosed for the <a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/GRUB2SecureBootBypass2021">grub bootloader</a>. I
found 2 of them (CVE-2021-20225 and CVE-2021-20233), and contributed a number of
other fixes for crashing bugs which we don't believe are exploitable. I found
them by applying fuzz testing to grub. Here's how.</p>
<p>This is a multi-part series: I think it will end up being 4 posts. I'm hoping to
cover:</p>
<ul>
<li>Part 1 (this post): getting started with fuzzing grub</li>
<li>Part 2: <a href="/blog/2021/06/14/fuzzing-grub-part-2-going-faster/">going faster by doing lots more work</a></li>
<li>Part 3: fuzzing filesystems and more</li>
<li>Part 4: potential next steps and avenues for further work</li>
</ul>
<h1>Fuzz testing</h1>
<p>Let's begin with part one: getting started with fuzzing grub.</p>
<p>One of my all-time favourite techniques for testing programs, especially
programs that handle untrusted input, and especially-especially programs written
in C that parse untrusted input, is fuzz testing. Fuzz testing (or fuzzing) is
the process of repeatedly throwing randomised data at your program under test
and seeing what it does.</p>
<p>(For the secure boot threat model, untrusted input is anything not validated by
a cryptographic signature - so config files are untrusted for our purposes, but
grub modules can only be loaded if they are signed, so they are trusted.)</p>
<p>Fuzzing has a long history and has recently received a new lease on life with
coverage-guided fuzzing tools like <a href="https://lcamtuf.coredump.cx/afl/">AFL</a> and
more recently <a href="https://aflplus.plus/">AFL++</a>.</p>
<h1>Building grub for AFL++</h1>
<p>AFL++ is extremely easy to use ... if your program:</p>
<ol>
<li>is built as a single binary with a regular tool-chain</li>
<li>runs as a regular user-space program on Linux</li>
<li>reads a small input files from disk and then exits</li>
<li>doesn't do anything fancy with threads or signals</li>
</ol>
<p>Beyond that, it gets a bit more complex.</p>
<p>On the face of it, grub fails 3 of these 4 criteria:</p>
<ul>
<li>
<p>grub is a highly modular program: it loads almost all of its functionality as
   modules which are linked as separate ELF relocatable files. (Not runnable
   programs, but not shared libraries either.)</p>
</li>
<li>
<p>grub usually runs as a bootloader, not as a regular app.</p>
</li>
<li>
<p>grub reads all sorts of things, ranging in size from small files to full
   disks. After loading most things, it returns to a command prompt rather than
   exiting.</p>
</li>
</ul>
<p>Fortunately, these problems are not insurmountable.</p>
<p>We'll start with the 'running as a bootloader' problem. Here, grub helps us out
a bit, because it provides an 'emulator' target, which runs most of grub
functionality as a userspace program. It doesn't support actually booting
anything (unsurprisingly) but it does support most other modules, including
things like the config file parser.</p>
<p>We can configure grub to build the emulator. We disable the graphical frontend
for now.</p>
<div class="highlight"><pre><span></span><code>:::shell
./bootstrap
./configure --with-platform=emu --disable-grub-emu-sdl
</code></pre></div>

<p>At this point in building a fuzzing target, we'd normally try to configure with
<code>afl-cc</code> to get the instrumentation that makes AFL(++) so powerful. However, the
grub configure script is not a fan:</p>
<div class="highlight"><pre><span></span><code>:::<span class="nv">text</span><span class="w"></span>
.<span class="o">/</span><span class="nv">configure</span><span class="w"> </span><span class="o">--</span><span class="nv">with</span><span class="o">-</span><span class="nv">platform</span><span class="o">=</span><span class="nv">emu</span><span class="w"> </span><span class="o">--</span><span class="nv">disable</span><span class="o">-</span><span class="nv">grub</span><span class="o">-</span><span class="nv">emu</span><span class="o">-</span><span class="nv">sdl</span><span class="w"> </span><span class="nv">CC</span><span class="o">=</span><span class="mh">$AF</span><span class="nv">L_PATH</span><span class="o">/</span><span class="nv">afl</span><span class="o">-</span><span class="nv">cc</span><span class="w"></span>
...<span class="w"></span>
<span class="nv">checking</span><span class="w"> </span><span class="nv">whether</span><span class="w"> </span><span class="nv">target</span><span class="w"> </span><span class="nv">compiler</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">working</span>...<span class="w"> </span><span class="nv">no</span><span class="w"></span>
<span class="nv">configure</span>:<span class="w"> </span><span class="nv">error</span>:<span class="w"> </span><span class="nv">cannot</span><span class="w"> </span><span class="nv">compile</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">target</span><span class="w"></span>
</code></pre></div>

<p>It also doesn't work with <code>afl-gcc</code>.</p>
<p>Hmm, ok, so what if we just... lie a bit?</p>
<div class="highlight"><pre><span></span><code>:::shell
./configure --with-platform=emu --disable-grub-emu-sdl
make CC=&quot;$AFL_PATH/afl-gcc&quot; 
</code></pre></div>

<p>(Normally I'd use <code>CC=clang</code> and <code>afl-cc</code>, but clang support is slightly broken
upstream at the moment.)</p>
<p>After a small fix for gcc-10 compatibility, we get the userspace tools
(potentially handy!) but a bunch of link errors for <code>grub-emu</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">:::</span><span class="n">text</span><span class="w"></span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="nl">ld:</span><span class="w"> </span><span class="n">disk</span><span class="p">.</span><span class="k">module</span><span class="o">:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">x20</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">definition</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="no">`__afl_global_area_ptr</span><span class="p">&#39;;</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="nl">exec:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">xe078</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">here</span><span class="w"></span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="nl">ld:</span><span class="w"> </span><span class="n">regexp</span><span class="p">.</span><span class="k">module</span><span class="o">:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">x70</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">definition</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="no">`__afl_global_area_ptr</span><span class="p">&#39;;</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="nl">exec:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">xe078</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">here</span><span class="w"></span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="nl">ld:</span><span class="w"> </span><span class="n">blocklist</span><span class="p">.</span><span class="k">module</span><span class="o">:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">x28</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">definition</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="no">`__afl_global_area_ptr</span><span class="p">&#39;;</span><span class="w"> </span><span class="n">kernel</span><span class="p">.</span><span class="nl">exec:</span><span class="p">(.</span><span class="n">bss</span><span class="o">+</span><span class="mh">0</span><span class="n">xe078</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">first</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="n">here</span><span class="w"></span>
</code></pre></div>

<p>The problem is the module linkage that I talked about earlier: because there is
a link stage of sorts for each module, some AFL support code gets linked in to
both the grub kernel (<code>kernel.exec</code>) and each module (here <code>disk.module</code>,
<code>regexp.module</code>, ...). The linker doesn't like it being in both, which is fair
enough.</p>
<p>To get started, let's instead take advantage of the smarts of AFL++ using Qemu
mode instead. This builds a specially instrumented qemu user-mode emulator
that's capable of doing coverage-guided fuzzing on uninstrumented binaries at
the cost of a significant performance penalty.</p>
<div class="highlight"><pre><span></span><code>:::shell
make clean
make
</code></pre></div>

<p>Now we have a grub-emu binary. If you run it directly, you'll pick up your
system boot configuration, but the <code>-d</code> option can point it to a directory of
your choosing. Let's set up one for fuzzing:</p>
<div class="highlight"><pre><span></span><code>:::shell
mkdir stage
echo &quot;echo Hello sthbrx readers&quot; &gt; stage/grub.cfg
cd stage
../grub-core/grub-emu -d .
</code></pre></div>

<p>You probably won't see the message because the screen gets blanked at the end of
running the config file, but if you pipe it through <code>less</code> or something you'll
see it.</p>
<h1>Running the fuzzer</h1>
<p>So, that seems to work - let's create a test input and try fuzzing:</p>
<div class="highlight"><pre><span></span><code>:::<span class="nv">shell</span><span class="w"></span>
<span class="nv">cd</span><span class="w"> </span>..<span class="w"></span>
<span class="nv">mkdir</span><span class="w"> </span><span class="nv">in</span><span class="w"></span>
<span class="nv">echo</span><span class="w"> </span><span class="s2">&quot;echo hi&quot;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nv">in</span><span class="o">/</span><span class="nv">echo</span><span class="o">-</span><span class="nv">hi</span><span class="w"></span>

<span class="nv">cd</span><span class="w"> </span><span class="nv">stage</span><span class="w"></span>
#<span class="w"> </span><span class="o">-</span><span class="nv">Q</span><span class="w"> </span><span class="nv">qemu</span><span class="w"> </span><span class="nv">mode</span><span class="w"></span>
#<span class="w"> </span><span class="o">-</span><span class="nv">M</span><span class="w"> </span><span class="nv">main</span><span class="w"> </span><span class="nv">fuzzer</span><span class="w"></span>
#<span class="w"> </span><span class="o">-</span><span class="nv">d</span><span class="w"> </span><span class="nv">don</span><span class="err">&#39;t do deterministic steps (too slow for a text format)</span>
<span class="err"># -f create file grub.cfg</span>
<span class="err">$AFL_PATH/afl-fuzz -Q -i ../in -o ../out -M main -d -- ../grub-core/grub-emu -d .</span><span class="w"></span>
</code></pre></div>

<p>Sadly:</p>
<div class="highlight"><pre><span></span><code><span class="c">:::text</span>
<span class="k">[</span><span class="nb">-</span><span class="k">]</span><span class="c"> The program took more than 1000 ms to process one of the initial test cases</span><span class="nt">.</span><span class="c"></span>
<span class="c">    This is bad news; raising the limit with the </span><span class="nb">-</span><span class="c">t option is possible</span><span class="nt">,</span><span class="c"> but</span>
<span class="c">    will probably make the fuzzing process extremely slow</span><span class="nt">.</span><span class="c"></span>

<span class="c">    If this test case is just a fluke</span><span class="nt">,</span><span class="c"> the other option is to just avoid it</span>
<span class="c">    altogether</span><span class="nt">,</span><span class="c"> and find one that is less of a CPU hog</span><span class="nt">.</span><span class="c"></span>

<span class="k">[</span><span class="nb">-</span><span class="k">]</span><span class="c"> PROGRAM ABORT : Test case &#39;id:000000</span><span class="nt">,</span><span class="c">time:0</span><span class="nt">,</span><span class="c">orig:echo</span><span class="nb">-</span><span class="c">hi&#39; results in a timeout</span>
<span class="c">         Location : perform_dry_run()</span><span class="nt">,</span><span class="c"> src/afl</span><span class="nb">-</span><span class="c">fuzz</span><span class="nb">-</span><span class="c">init</span><span class="nt">.</span><span class="c">c:866</span>
</code></pre></div>

<p>What we're seeing here (and indeed what you can observe if you run <code>grub-emu</code>
directly) is that <code>grub-emu</code> isn't exiting when it's done. It's waiting for more
input, and will keep waiting for input until it's killed by <code>afl-fuzz</code>.</p>
<p>We need to patch grub to sort that out. It's on <a href="https://github.com/daxtens/grub/commit/ad2e84224e674eb1f9dcd8efc3d8efe78ed62bec">my GitHub</a>.</p>
<p>Apply that, rebuild with <code>FUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION</code>, and voila:</p>
<div class="highlight"><pre><span></span><code>:::shell
cd ..
make CFLAGS=&quot;-DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION&quot;
cd stage
$AFL_PATH/afl-fuzz -Q -i ../in -o ../out -M main -d -f grub.cfg -- ../grub-core/grub-emu -d .
</code></pre></div>

<p>And fuzzing is happening!</p>
<p><img alt="afl-fuzz fuzzing grub, showing fuzzing happening" src="/images/dja/grub-fuzzing-pt1.png"></p>
<p>This is enough to find some of the (now-fixed) bugs in the grub config file
parsing!</p>
<h1>Fuzzing beyond the config file</h1>
<p>You can also extend this to fuzzing other things that don't require the
graphical UI, such as grub's transparent decompression support:</p>
<div class="highlight"><pre><span></span><code>:::shell
cd ..
rm -rf in out stage
mkdir in stage
echo hi &gt; in/hi
gzip in/hi
cd stage
echo &quot;cat thefile&quot; &gt; grub.cfg
$AFL_PATH/afl-fuzz -Q -i ../in -o ../out -M main -f thefile -- ../grub-core/grub-emu -d .
</code></pre></div>

<p>You should be able to find a hang pretty quickly with this, an as-yet-unfixed
bug where grub will print output forever from a corrupt file: (your mileage may
vary, as will the paths.)</p>
<div class="highlight"><pre><span></span><code>:::shell
cp ../out/main/hangs/id:000000,src:000000,time:43383,op:havoc,rep:16 thefile
../grub-core/grub-emu -d . | less # observe this going on forever
</code></pre></div>

<p><code>zcat</code>, on the other hand, reports it as simply corrupt:</p>
<div class="highlight"><pre><span></span><code>:::text
$ zcat thefile

gzip: thefile: invalid compressed data--format violated
</code></pre></div>

<p>(Feel free to fix that and send a patch to the list!)</p>
<p>That wraps up part 1. Eventually I'll be back with part 2, where I explain the
hoops to jump through to go faster with the <code>afl-cc</code> instrumentation.</p></div>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://sthbrx.github.io/blog/2020/01/22/linuxconfau-2020-recap/">linux.conf.au 2020 recap</a>
      </h1>
    <p class="meta">
<time datetime="2020-01-22T16:00:00+11:00" pubdate>Wed 22 January 2020</time>    </p>
</header>

<div class="byline_index">
  <span class="byline author vcard">
    Posted by <span class="fn">
          <a href="https://sthbrx.github.io/author/andrew-donnellan.html">Andrew Donnellan</a>
    </span>
  </span>
<time datetime="2020-01-22T16:00:00+11:00" pubdate>Wed 22 January 2020</time></div>

  <div class="entry-content"><p>It's that time of year again. Most of OzLabs headed up to the Gold Coast for linux.conf.au 2020.</p>
<p>linux.conf.au is one of the longest-running community-led Linux and Free Software events in the world, and attracts a crowd from Australia, New Zealand and much further afield. OzLabbers have been involved in LCA since the very beginning and this year was no exception with myself running the Kernel Miniconf and several others speaking.</p>
<p>The list below contains some of our highlights that we think you should check out. This is just a few of the talks that we managed to make it to - there's plenty more worthwhile stuff on the <a href="https://www.youtube.com/user/linuxconfau2019/featured">linux.conf.au YouTube channel</a>.</p>
<p>We'll see you all at LCA2021 right here in Canberra...</p>
<h1>Keynotes</h1>
<p>A couple of the keynotes really stood out:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=Yv4tI6939q0">Sean Brady - Drop Your Tools - Does Expertise have a Dark Side?</a></li>
</ul>
<p>Sean is a forensic structural engineer who shows us a variety of examples, from structural collapses and firefighting disasters, where trained professionals were blinded by their expertise and couldn't bring themselves to do things that were obvious.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=xfpy5c3thQo">Vanessa Teague - Who cares about Democracy?</a></li>
</ul>
<p>There's nothing quite like cryptography proofs presented to a keynote audience at 9:30 in the morning. Vanessa goes over the issues with electronic voting systems in Australia, and especially internet voting as used in NSW, including flaws in their implementation of cryptographic algorithms. There continues to be no good way to do internet voting, but with developments in methodologies like risk-limiting audits there may be reasonably safe ways to do in-person electronic voting.</p>
<h1>OpenPOWER</h1>
<p>There was an OpenISA miniconf, co-organised by none other than Hugh Blemings of the OpenPOWER Foundation.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=RU6RPYAqFzE">Michael Neuling / Anton Blanchard - Power OpenISA and Microwatt Introduction</a></li>
</ul>
<p>Anton (on Mikey's behalf) introduces the Power OpenISA and the Microwatt FPGA core which has been released to go with it.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=g3slH03MCmo">Anton Blanchard - Build your own Open Hardware CPU in 25 minutes or less</a></li>
</ul>
<p>Anton live demos Microwatt in simulation, and also tries to synthesise it for his FPGA but runs out of time...</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=JkDx_y0onSk">Paul Mackerras - Microwatt Microarchitecture</a></li>
</ul>
<p>Paul presents an in-depth overview of the design of the Microwatt core.</p>
<h1>Kernel</h1>
<p>There were quite a few kernel talks, both in the <a href="http://lca-kernel.ozlabs.org">Kernel Miniconf</a> and throughout the main conference. These are just some of them:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=ggD-eb3yPVs">Aleksa Sarai - Designing Extensible Syscalls</a></li>
</ul>
<p>There's been many cases where we've introduced a syscall only to find out later on that we need to add some new parameters - how do we make our syscalls extensible so we can add new parameters later on without needing to define a whole new syscall, while maintaining both forward and backward compatibility? It turns out it's pretty simple but needs a few more kernel helpers.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=heib48KG-YQ">Russell Currey - Kernel hacking like it's 2020</a></li>
</ul>
<p>There are a bunch of tools out there which you can use to make your kernel hacking experience much more pleasant. You should use them.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=tGseJW_uBB8">Aleksa Sarai - Securing Container Runtimes - How Hard Can It Be?</a></li>
</ul>
<p>Among other security issues with container runtimes, using procfs to setup security controls during the startup of a container is fraught with hilarious problems, because procfs and the Linux filesystem API aren't really designed to do this safely, and also have a bunch of amusing bugs.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=0Bj6W7qrOOI">Kees Cook - Control Flow Integrity in the Linux Kernel</a></li>
</ul>
<p>Control Flow Integrity is a technique for restricting exploit techniques that hijack a program's control flow (e.g. by overwriting a return address on the stack (ROP), or overwriting a function pointer that's used in an indirect jump). Kees goes through the current state of CFI supporting features in hardware and what is currently available to enable CFI in the kernel.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=p5u-vbwu3Fs">Matthew Wilcox - Large Pages in Linux</a></li>
</ul>
<p>Linux has supported huge pages for many years, which has significantly improved CPU performance. However, the huge page mechanism was driven by hardware advancements and is somewhat inflexible, and it's just as important to consider software overhead. Matthew has been working on supporting more flexible "large pages" in the page cache to do just that.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=9Fzd6MapG3Y">Russell Currey - The magical fantasy land of Linux kernel testing</a></li>
</ul>
<p>Spoiler: the magical fantasy land is a trap.</p>
<h1>Community</h1>
<p>Lots of community and ethics discussion this year - one talk which stood out to me:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=n55WClalwHo">Bradley M. Kuhn / Karen Sandler - Open Source Won, but Software Freedom Hasn't Yet: A Guide &amp; Commisseration Session for FOSS activists</a></li>
</ul>
<p>Bradley and Karen argue that while open source has "won", software freedom has regressed in recent years, and present their vision for what modern, pragmatic Free Software activism should look like.</p>
<h1>Other</h1>
<p>Among the variety of other technical talks at LCA...</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=L2P501Iy6J8">Matthew Treinish - Building a Compiler for Quantum Computers</a></li>
</ul>
<p>Quantum compilers are not really like regular classical compilers (indeed, they're really closer to FPGA synthesis tools). Matthew talks through how quantum compilers map a program on to IBM's quantum hardware and the types of optimisations they apply.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=Dk6ZuydQt9I">Fraser Tweedale - Clevis and Tang: securing your secrets at rest</a></li>
</ul>
<p>Clevis and Tang provide an implementation of "network bound encryption", allowing you to magically decrypt your secrets when you are on a secure network with access to the appropriate Tang servers. This talk outlines use cases and provides a demonstration.</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=uBBaVtHkiOI">Christoph Lameter - How to capture 100G Ethernet traffic at wire speed to local disk</a></li>
</ul>
<p>Christoph discusses how to deal with the hardware and software limitations that make it difficult to capture traffic at wire speed on fast fibre networks.</p></div>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://sthbrx.github.io/blog/2019/12/18/rfid-and-hrfid/">rfid and hrfid</a>
      </h1>
    <p class="meta">
<time datetime="2019-12-18T17:30:00+11:00" pubdate>Wed 18 December 2019</time>    </p>
</header>

<div class="byline_index">
  <span class="byline author vcard">
    Posted by <span class="fn">
          <a href="https://sthbrx.github.io/author/andrew-donnellan.html">Andrew Donnellan</a>
    </span>
  </span>
<time datetime="2019-12-18T17:30:00+11:00" pubdate>Wed 18 December 2019</time></div>

  <div class="entry-content"><p>I was staring at some assembly recently, and for not the first time encountered <em>rfid</em> and <em>hrfid</em>, two instructions that we use when doing things like returning to userspace, returning from OPAL to the kernel, or from a host kernel into a guest.</p>
<p><em>rfid</em> copies various bits from the register SRR1 (Machine Status Save/Restore Register 1) into the MSR (Machine State Register), and then jumps to an address given in SRR0 (Machine Status Save/Restore Register 0). <em>hrfid</em> does something similar, using HSRR0 and HSRR1 (Hypervisor Machine Status Save/Restore Registers 0/1), and slightly different handling of MSR bits.</p>
<p>The various Save/Restore Registers are used to preserve the state of the CPU before jumping to an interrupt handler, entering the kernel, etc, and are set up as part of instructions like <em>sc</em> (System Call), by the interrupt mechanism, or manually (using instructions like <em>mtsrr1</em>).</p>
<p>Anyway, the way in which <em>rfid</em> and <em>hrfid</em> restores MSR bits is documented somewhat obtusely in the ISA (if you don't believe me, look it up), and I was annoyed by this, so here, have a more useful definition. Leave a comment if I got something wrong.</p>
<h1>rfid - Return From Interrupt Doubleword</h1>
<h2>Machine State Register</h2>
<p>Copy all bits (except some reserved bits) from SRR1 into the MSR, with the following exceptions:</p>
<ul>
<li>
<p>MSR_3 (HV, Hypervisor State) = MSR_3 &amp; SRR1_3<br>
[We won't put the thread into hypervisor state if we're not already in hypervisor state]</p>
</li>
<li>
<p>If MSR_29:31 != 0b010 [Transaction State Suspended, TM not available], or SRR1_29:31 != 0b000 [Transaction State Non-transactional, TM not available] then:</p>
<ul>
<li>MSR_29:30 (TS, Transaction State) = SRR1_29:30</li>
<li>MSR_31 (TM, Transactional Memory Available) = SRR1_31</li>
</ul>
<p>[See the ISA description for explanation on how rfid interacts with TM and resulting interrupts]</p>
</li>
<li>
<p>MSR_48 (EE, External Interrupt Enable) = SRR1_48 | SRR1_49 (PR, Problem State)<br>
[If going into problem state, external interrupts will be enabled]</p>
</li>
<li>
<p>MSR_51 (ME, Machine Check Interrupt Enable) = (MSR_3 (HV, Hypervisor State) &amp; SRR1_51) | ((! MSR_3) &amp; MSR_51)<br>
[If we're not already in hypervisor state, we won't alter ME]</p>
</li>
<li>
<p>MSR_58 (IR, Instruction Relocate) = SRR1_58 | SRR1_49 (PR, Problem State)<br>
[If going into problem state, relocation will be enabled]</p>
</li>
<li>
<p>MSR_59 (DR, Data Relocate) = SRR1_59 | SRR1_49 (PR, Problem State)<br>
[If going into problem state, relocation will be enabled]</p>
</li>
</ul>
<h2>Next Instruction Address</h2>
<ul>
<li>NIA = SRR0_0:61 || 0b00<br>
[Jump to SRR0, set last 2 bits to zero to ensure address is aligned to 4 bytes]</li>
</ul>
<h1>hrfid - Hypervisor Return From Interrupt Doubleword</h1>
<h2>Machine State Register</h2>
<p>Copy all bits (except some reserved bits) from HSRR1 into the MSR, with the following exceptions:</p>
<ul>
<li>
<p>If MSR_29:31 != 0b010 [Transaction State Suspended, TM not available], or HSRR1_29:31 != 0b000 [Transaction State Non-transactional, TM not available] then:</p>
<ul>
<li>MSR_29:30 (TS, Transaction State) = HSRR1_29:30</li>
<li>MSR_31 (TM, Transactional Memory Available) = HSRR1_31</li>
</ul>
<p>[See the ISA description for explanation on how rfid interacts with TM and resulting interrupts]</p>
</li>
<li>
<p>MSR_48 (EE, External Interrupt Enable) = HSRR1_48 | HSRR1_49 (PR, Problem State)<br>
[If going into problem state, external interrupts will be enabled]</p>
</li>
<li>
<p>MSR_58 (IR, Instruction Relocate) = HSRR1_58 | HSRR1_49 (PR, Problem State)<br>
[If going into problem state, relocation will be enabled]</p>
</li>
<li>
<p>MSR_59 (DR, Data Relocate) = HSRR1_59 | HSRR1_49 (PR, Problem State)<br>
[If going into problem state, relocation will be enabled]</p>
</li>
</ul>
<h2>Next Instruction Address</h2>
<ul>
<li>NIA = HSRR0_0:61 || 0b00<br>
[Jump to HSRR0, set last 2 bits to zero to ensure address is aligned to 4 bytes]</li>
</ul></div>
  		</article>
  		<article>
<header>
      <h1 class="entry-title">
        <a href="https://sthbrx.github.io/blog/2019/06/18/ten-thousand-disks/">TEN THOUSAND DISKS</a>
      </h1>
    <p class="meta">
<time datetime="2019-06-18T16:47:00+10:00" pubdate>Tue 18 June 2019</time>    </p>
</header>

<div class="byline_index">
  <span class="byline author vcard">
    Posted by <span class="fn">
          <a href="https://sthbrx.github.io/author/samuel-mendoza-jonas.html">Samuel Mendoza-Jonas</a>
    </span>
  </span>
<time datetime="2019-06-18T16:47:00+10:00" pubdate>Tue 18 June 2019</time></div>

  <div class="entry-content"><p>In OpenPOWER land we have a project called <a href="https://github.com/open-power/op-test-framework/">op-test-framework</a> which (for all its strengths and weaknesses) allows us to test firmware on a variety of different hardware platforms and even emulators like Qemu.</p>
<p>Qemu is a fantasic tool allowing us to relatively quickly test against an emulated POWER model, and of course is a critical part of KVM virtual machines running natively on POWER hardware. However the default POWER model in Qemu is based on the "pseries" machine type, which models something closer to a virtual machine or a PowerVM partition rather than a "bare metal" machine.</p>
<p>Luckily we have <a href="https://github.com/legoater">Cdric Le Goater</a> who is <a href="https://github.com/legoater/qemu">developing and maintaining</a> a Qemu "powernv" machine type which more accurately models running directly on an OpenPOWER machine. It's an unwritten rule that if you're using Qemu in op-test, you've compiled this version of Qemu!</p>
<h2>Teething Problems</h2>
<p>Because the "powernv" type does more accurately model the physical system some extra care needs to be taken when setting it up. In particular at one point we noticed that the pretend CDROM and disk drive we attached to the model were.. not being attached. <a href="https://github.com/open-power/op-test-framework/commit/1a97bc92c6029cfda91f565face260b806c04d86">This commit</a> took care of that; the problem was that the <a href="https://github.com/legoater/qemu/wiki/PowerNV#complex-configuration">PCI topology</a> defined by the layout required us to be more exact about where PCI devices were to be added. By default only three spare PCI "slots" are available but as the commit says, "This can be expanded by adding bridges"...</p>
<h2>More Slots!</h2>
<p>Never one to stop at a just-enough solution, I wondered how easy it would be to add an extra PCI bridge or two to give the Qemu model more available slots for PCI devices. It turns out, easy enough once you know the correct invocation. For example, adding a PCI bridge in the first slot of the first default PHB is:</p>
<div class="highlight"><pre><span></span><code>-device pcie-pci-bridge,id=pcie.3,bus=pcie.0,addr=0x0
</code></pre></div>

<p>And inserting a device in that bridge just requires us to specify the bus and slot:</p>
<div class="highlight"><pre><span></span><code>-device virtio-blk-pci,drive=cdrom01,id=virtio02,bus=pcie.4,addr=3
</code></pre></div>

<p>Great! Each bridge provides 31 slots, so now we have plenty of room for extra devices.</p>
<h2>Why Stop There?</h2>
<p>We have three free slots, and we don't have a strict requirement on where devices are plugged in, so lets just plug a bridge into each of those slots while we're here:</p>
<div class="highlight"><pre><span></span><code>-device pcie-pci-bridge,id=pcie.3,bus=pcie.0,addr=0x0 \
-device pcie-pci-bridge,id=pcie.4,bus=pcie.1,addr=0x0 \
-device pcie-pci-bridge,id=pcie.5,bus=pcie.2,addr=0x0
</code></pre></div>

<p>What happens if we insert a new PCI bridge into another PCI bridge? Aside from stressing out our PCI developers, a bunch of extra slots! And then we could plug bridges into those bridges and then..</p>
<iframe src="https://giphy.com/embed/VB5WwlZIt8eRy" width="480" height="199" frameBorder="0" class="giphy-embed" allowFullScreen></iframe>
<p><br></p>
<p>Thus was born <a href="https://github.com/open-power/op-test-framework/commit/6e78eea78a2f2cf37ebdd2cccbd5b18a7050c1eb">"OpTestQemu: Add PCI bridges to support more devices."</a> and the testcase <a href="https://github.com/open-power/op-test-framework/blob/master/testcases/Petitboot10000Disks.py">"Petitboot10000Disks"</a>.
The changes to the Qemu model setup fill up each PCI bridge as long as we have devices to add, but reserve the first slot to add another bridge if we run out of room... and so on..</p>
<p>Officially this is to support adding interesting disk topologies to test Pettiboot use cases, stress test device handling, and so on, but while we're here... what happens with 10,000 temporary disks?</p>
<div class="highlight"><pre><span></span><code><span class="o">======================================================================</span><span class="w"></span>
<span class="nl">ERROR</span><span class="p">:</span><span class="w"> </span><span class="n">testListDisks</span><span class="w"> </span><span class="p">(</span><span class="n">testcases</span><span class="p">.</span><span class="n">Petitboot10000Disks</span><span class="p">.</span><span class="n">ConfigEditorTestCase</span><span class="p">)</span><span class="w"></span>
<span class="o">----------------------------------------------------------------------</span><span class="w"></span>
<span class="n">Traceback</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="k">last</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">  </span><span class="k">File</span><span class="w"> </span><span class="ss">&quot;/home/sam/git/op-test-framework/testcases/Petitboot10000Disks.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">27</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">setUp</span><span class="w"></span>
<span class="w">    </span><span class="n">self</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">goto_state</span><span class="p">(</span><span class="n">OpSystemState</span><span class="p">.</span><span class="n">PETITBOOT_SHELL</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="k">File</span><span class="w"> </span><span class="ss">&quot;/home/sam/git/op-test-framework/common/OpTestSystem.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">366</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">goto_state</span><span class="w"></span>
<span class="w">    </span><span class="n">self</span><span class="p">.</span><span class="k">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">stateHandlers</span><span class="o">[</span><span class="n">self.state</span><span class="o">]</span><span class="p">(</span><span class="k">state</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="k">File</span><span class="w"> </span><span class="ss">&quot;/home/sam/git/op-test-framework/common/OpTestSystem.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">695</span><span class="p">,</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">run_IPLing</span><span class="w"></span>
<span class="w">    </span><span class="n">raise</span><span class="w"> </span><span class="n">my_exception</span><span class="w"></span>
<span class="nl">UnknownStateTransition</span><span class="p">:</span><span class="w"> </span><span class="n">Something</span><span class="w"> </span><span class="n">happened</span><span class="w"> </span><span class="k">system</span><span class="w"> </span><span class="k">state</span><span class="o">=</span><span class="ss">&quot;2&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">transitioned</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">UNKNOWN</span><span class="w"> </span><span class="k">state</span><span class="p">.</span><span class="w">  </span><span class="n">Review</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">details</span><span class="w"></span>
<span class="n">Message</span><span class="o">=</span><span class="ss">&quot;OpTestSystem in run_IPLing and the Exception=</span>
<span class="ss">&quot;</span><span class="n">filedescriptor</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">range</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">select</span><span class="p">()</span><span class="ss">&quot;</span>
<span class="ss"> caused the system to go to UNKNOWN_BAD and the system will be stopping.&quot;</span><span class="w"></span>
</code></pre></div>

<p>Yeah that's probably to be expected without some more massaging. What about a more modest 512?</p>
<div class="highlight"><pre><span></span><code><span class="n">I</span><span class="o">:</span><span class="w"> </span><span class="n">Resetting</span><span class="w"> </span><span class="n">PHBs</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">training</span><span class="w"> </span><span class="n">links</span><span class="o">...</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">55.293343496</span><span class="o">,</span><span class="mi">5</span><span class="o">]</span><span class="w"> </span><span class="n">PCI</span><span class="o">:</span><span class="w"> </span><span class="n">Probing</span><span class="w"> </span><span class="n">slots</span><span class="o">...</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">56.364337089</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0000</span><span class="o">:</span><span class="mi">02</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">56.364973775</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0000</span><span class="o">:</span><span class="mi">02</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">57.127964432</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0000</span><span class="o">:</span><span class="mi">03</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">57.128545637</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0000</span><span class="o">:</span><span class="mi">03</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">57.395489618</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0000</span><span class="o">:</span><span class="mi">04</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">57.396048285</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0000</span><span class="o">:</span><span class="mi">04</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">58.145944205</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0000</span><span class="o">:</span><span class="mi">05</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">58.146465795</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0000</span><span class="o">:</span><span class="mi">05</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">58.404954853</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0000</span><span class="o">:</span><span class="mi">06</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">58.405485438</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0000</span><span class="o">:</span><span class="mi">06</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">60.178957315</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">02</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">60.179524173</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">02</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">60.198502097</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">02</span><span class="o">:</span><span class="mf">02.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">60.198982582</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">02</span><span class="o">:</span><span class="mf">02.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">60.435096197</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">03</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">60.435634380</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">03</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">61.171512439</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">04</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">61.172029071</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">04</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">61.425416049</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">05</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">61.425934524</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">05</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">62.172664549</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">06</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">62.173186458</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0001</span><span class="o">:</span><span class="mi">06</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">63.434516732</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0002</span><span class="o">:</span><span class="mi">02</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">63.435062124</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0002</span><span class="o">:</span><span class="mi">02</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">64.177567772</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0002</span><span class="o">:</span><span class="mi">03</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">64.178099773</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0002</span><span class="o">:</span><span class="mi">03</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">64.431763989</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0002</span><span class="o">:</span><span class="mi">04</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">64.432285000</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0002</span><span class="o">:</span><span class="mi">04</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">65.180506790</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0002</span><span class="o">:</span><span class="mi">05</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">65.181049905</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0002</span><span class="o">:</span><span class="mi">05</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">65.432105600</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0002</span><span class="o">:</span><span class="mi">06</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
<span class="o">[</span><span class="w">   </span><span class="mf">65.432654326</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span><span class="w"> </span><span class="n">PHB</span><span class="err">#</span><span class="mi">0002</span><span class="o">:</span><span class="mi">06</span><span class="o">:</span><span class="mf">01.0</span><span class="w"> </span><span class="n">pci_find_ecap</span><span class="w"> </span><span class="n">hit</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="o">!</span><span class="w"></span>
</code></pre></div>

<p>(That isn't good)</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">   66.177240655,5</span><span class="o">]</span><span class="w"> </span><span class="n">PCI</span><span class="w"> </span><span class="nl">Summary</span><span class="p">:</span><span class="w"></span>
<span class="o">[</span><span class="n">   66.177906083,5</span><span class="o">]</span><span class="w"> </span><span class="n">PHB#0000</span><span class="err">:</span><span class="mi">00</span><span class="err">:</span><span class="mf">00.0</span><span class="w"> </span><span class="o">[</span><span class="n">ROOT</span><span class="o">]</span><span class="w"> </span><span class="mi">1014</span><span class="w"> </span><span class="mi">03</span><span class="n">dc</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="mi">060400</span><span class="w"> </span><span class="nl">B</span><span class="p">:</span><span class="mf">01..07</span><span class="w"> </span>
<span class="o">[</span><span class="n">   66.178760724,5</span><span class="o">]</span><span class="w"> </span><span class="n">PHB#0000</span><span class="err">:</span><span class="mi">01</span><span class="err">:</span><span class="mf">00.0</span><span class="w"> </span><span class="o">[</span><span class="n">ETOX</span><span class="o">]</span><span class="w"> </span><span class="mi">1</span><span class="n">b36</span><span class="w"> </span><span class="mi">000</span><span class="n">e</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="mi">060400</span><span class="w"> </span><span class="nl">B</span><span class="p">:</span><span class="mf">02..07</span><span class="w"> </span>
<span class="o">[</span><span class="n">   66.179501494,5</span><span class="o">]</span><span class="w"> </span><span class="n">PHB#0000</span><span class="err">:</span><span class="mi">02</span><span class="err">:</span><span class="mf">01.0</span><span class="w"> </span><span class="o">[</span><span class="n">ETOX</span><span class="o">]</span><span class="w"> </span><span class="mi">1</span><span class="n">b36</span><span class="w"> </span><span class="mi">000</span><span class="n">e</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="mi">060400</span><span class="w"> </span><span class="nl">B</span><span class="p">:</span><span class="mf">03..07</span><span class="w"> </span>
<span class="o">[</span><span class="n">   66.180227773,5</span><span class="o">]</span><span class="w"> </span><span class="n">PHB#0000</span><span class="err">:</span><span class="mi">03</span><span class="err">:</span><span class="mf">01.0</span><span class="w"> </span><span class="o">[</span><span class="n">ETOX</span><span class="o">]</span><span class="w"> </span><span class="mi">1</span><span class="n">b36</span><span class="w"> </span><span class="mi">000</span><span class="n">e</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="mi">060400</span><span class="w"> </span><span class="nl">B</span><span class="p">:</span><span class="mf">04..07</span><span class="w"> </span>
<span class="o">[</span><span class="n">   66.180953149,5</span><span class="o">]</span><span class="w"> </span><span class="n">PHB#0000</span><span class="err">:</span><span class="mi">04</span><span class="err">:</span><span class="mf">01.0</span><span class="w"> </span><span class="o">[</span><span class="n">ETOX</span><span class="o">]</span><span class="w"> </span><span class="mi">1</span><span class="n">b36</span><span class="w"> </span><span class="mi">000</span><span class="n">e</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="mi">060400</span><span class="w"> </span><span class="nl">B</span><span class="p">:</span><span class="mf">05..07</span><span class="w"> </span>
<span class="o">[</span><span class="n">   66.181673576,5</span><span class="o">]</span><span class="w"> </span><span class="n">PHB#0000</span><span class="err">:</span><span class="mi">05</span><span class="err">:</span><span class="mf">01.0</span><span class="w"> </span><span class="o">[</span><span class="n">ETOX</span><span class="o">]</span><span class="w"> </span><span class="mi">1</span><span class="n">b36</span><span class="w"> </span><span class="mi">000</span><span class="n">e</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="mi">060400</span><span class="w"> </span><span class="nl">B</span><span class="p">:</span><span class="mf">06..07</span><span class="w"> </span>
<span class="o">[</span><span class="n">   66.182395253,5</span><span class="o">]</span><span class="w"> </span><span class="n">PHB#0000</span><span class="err">:</span><span class="mi">06</span><span class="err">:</span><span class="mf">01.0</span><span class="w"> </span><span class="o">[</span><span class="n">ETOX</span><span class="o">]</span><span class="w"> </span><span class="mi">1</span><span class="n">b36</span><span class="w"> </span><span class="mi">000</span><span class="n">e</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="mi">060400</span><span class="w"> </span><span class="nl">B</span><span class="p">:</span><span class="mf">07..07</span><span class="w"> </span>
<span class="o">[</span><span class="n">   66.183207399,5</span><span class="o">]</span><span class="w"> </span><span class="n">PHB#0000</span><span class="err">:</span><span class="mi">07</span><span class="err">:</span><span class="mf">02.0</span><span class="w"> </span><span class="o">[</span><span class="n">PCID</span><span class="o">]</span><span class="w"> </span><span class="mi">1</span><span class="n">af4</span><span class="w"> </span><span class="mi">1001</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="mi">010000</span><span class="w"> </span><span class="p">(</span><span class="w">          </span><span class="n">scsi</span><span class="p">)</span><span class="w"> </span>
<span class="o">[</span><span class="n">   66.183969138,5</span><span class="o">]</span><span class="w"> </span><span class="n">PHB#0000</span><span class="err">:</span><span class="mi">07</span><span class="err">:</span><span class="mf">03.0</span><span class="w"> </span><span class="o">[</span><span class="n">PCID</span><span class="o">]</span><span class="w"> </span><span class="mi">1</span><span class="n">af4</span><span class="w"> </span><span class="mi">1001</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="mi">010000</span><span class="w"> </span><span class="p">(</span><span class="w">          </span><span class="n">scsi</span><span class="p">)</span><span class="w"> </span>
</code></pre></div>

<p>(a lot more of this)</p>
<div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">   67.055196945,5</span><span class="o">]</span><span class="w"> </span><span class="n">PHB#0002</span><span class="err">:</span><span class="mi">02</span><span class="err">:</span><span class="mi">1</span><span class="n">e</span><span class="mf">.0</span><span class="w"> </span><span class="o">[</span><span class="n">PCID</span><span class="o">]</span><span class="w"> </span><span class="mi">1</span><span class="n">af4</span><span class="w"> </span><span class="mi">1001</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="mi">010000</span><span class="w"> </span><span class="p">(</span><span class="w">          </span><span class="n">scsi</span><span class="p">)</span><span class="w"> </span>
<span class="o">[</span><span class="n">   67.055926264,5</span><span class="o">]</span><span class="w"> </span><span class="n">PHB#0002</span><span class="err">:</span><span class="mi">02</span><span class="err">:</span><span class="mi">1</span><span class="n">f</span><span class="mf">.0</span><span class="w"> </span><span class="o">[</span><span class="n">PCID</span><span class="o">]</span><span class="w"> </span><span class="mi">1</span><span class="n">af4</span><span class="w"> </span><span class="mi">1001</span><span class="w"> </span><span class="nl">R</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="mi">010000</span><span class="w"> </span><span class="p">(</span><span class="w">          </span><span class="n">scsi</span><span class="p">)</span><span class="w"> </span>
<span class="o">[</span><span class="n">   67.094591773,5</span><span class="o">]</span><span class="w"> </span><span class="nl">INIT</span><span class="p">:</span><span class="w"> </span><span class="n">Waiting</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">kernel</span><span class="p">...</span><span class="w"></span>
<span class="o">[</span><span class="n">   67.095105901,5</span><span class="o">]</span><span class="w"> </span><span class="nl">INIT</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span><span class="o">-</span><span class="nc">bit</span><span class="w"> </span><span class="n">LE</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">discovered</span><span class="w"></span>
<span class="o">[</span><span class="n">   68.095749915,5</span><span class="o">]</span><span class="w"> </span><span class="nl">INIT</span><span class="p">:</span><span class="w"> </span><span class="n">Starting</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mh">0x20010000</span><span class="p">,</span><span class="w"> </span><span class="n">fdt</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mh">0x3075d270</span><span class="w"> </span><span class="mi">168365</span><span class="w"> </span><span class="n">bytes</span><span class="w"></span>

<span class="n">zImage</span><span class="w"> </span><span class="nl">starting</span><span class="p">:</span><span class="w"> </span><span class="n">loaded</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mh">0x0000000020010000</span><span class="w"> </span><span class="p">(</span><span class="nl">sp</span><span class="p">:</span><span class="w"> </span><span class="mh">0x0000000020d30ee8</span><span class="p">)</span><span class="w"></span>
<span class="n">Allocating</span><span class="w"> </span><span class="mh">0x1dc5098</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">kernel</span><span class="p">...</span><span class="w"></span>
<span class="n">Decompressing</span><span class="w"> </span><span class="p">(</span><span class="mh">0x0000000000000000</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="mh">0x000000002001f000</span><span class="err">:</span><span class="mh">0x0000000020d2e578</span><span class="p">)...</span><span class="w"></span>
<span class="n">Done</span><span class="err">!</span><span class="w"> </span><span class="n">Decompressed</span><span class="w"> </span><span class="mh">0x1c22900</span><span class="w"> </span><span class="n">bytes</span><span class="w"></span>

<span class="n">Linux</span><span class="o">/</span><span class="n">PowerPC</span><span class="w"> </span><span class="k">load</span><span class="err">:</span><span class="w"> </span>
<span class="n">Finalizing</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">tree</span><span class="p">...</span><span class="w"> </span><span class="n">flat</span><span class="w"> </span><span class="n">tree</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="mh">0x20d320a0</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.120562</span><span class="o">]</span><span class="w"> </span><span class="nl">watchdog</span><span class="p">:</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">self</span><span class="o">-</span><span class="n">detected</span><span class="w"> </span><span class="n">hard</span><span class="w"> </span><span class="n">LOCKUP</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="n">pnv_pci_cfg_write</span><span class="o">+</span><span class="mh">0x88</span><span class="o">/</span><span class="mh">0xa4</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.120746</span><span class="o">]</span><span class="w"> </span><span class="nl">watchdog</span><span class="p">:</span><span class="w"> </span><span class="n">CPU</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nl">TB</span><span class="p">:</span><span class="mi">50402010473</span><span class="p">,</span><span class="w"> </span><span class="k">last</span><span class="w"> </span><span class="n">heartbeat</span><span class="w"> </span><span class="nl">TB</span><span class="p">:</span><span class="mi">45261673150</span><span class="w"> </span><span class="p">(</span><span class="mi">10039</span><span class="n">ms</span><span class="w"> </span><span class="n">ago</span><span class="p">)</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.120808</span><span class="o">]</span><span class="w"> </span><span class="n">Modules</span><span class="w"> </span><span class="n">linked</span><span class="w"> </span><span class="ow">in</span><span class="err">:</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.120906</span><span class="o">]</span><span class="w"> </span><span class="nl">CPU</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nl">PID</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nl">Comm</span><span class="p">:</span><span class="w"> </span><span class="n">swapper</span><span class="o">/</span><span class="mi">0</span><span class="w"> </span><span class="ow">Not</span><span class="w"> </span><span class="n">tainted</span><span class="w"> </span><span class="mf">5.0.5</span><span class="o">-</span><span class="n">openpower1</span><span class="w"> </span><span class="n">#2</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.120956</span><span class="o">]</span><span class="w"> </span><span class="nl">NIP</span><span class="p">:</span><span class="w">  </span><span class="n">c000000000058544</span><span class="w"> </span><span class="nl">LR</span><span class="p">:</span><span class="w"> </span><span class="n">c00000000004d458</span><span class="w"> </span><span class="nl">CTR</span><span class="p">:</span><span class="w"> </span><span class="mi">0000000030052768</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.121006</span><span class="o">]</span><span class="w"> </span><span class="nl">REGS</span><span class="p">:</span><span class="w"> </span><span class="n">c0000000fff5bd70</span><span class="w"> </span><span class="nl">TRAP</span><span class="p">:</span><span class="w"> </span><span class="mi">0900</span><span class="w">   </span><span class="ow">Not</span><span class="w"> </span><span class="n">tainted</span><span class="w">  </span><span class="p">(</span><span class="mf">5.0.5</span><span class="o">-</span><span class="n">openpower1</span><span class="p">)</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.121030</span><span class="o">]</span><span class="w"> </span><span class="nl">MSR</span><span class="p">:</span><span class="w">  </span><span class="mi">9000000002009033</span><span class="w"> </span><span class="o">&lt;</span><span class="n">SF</span><span class="p">,</span><span class="n">HV</span><span class="p">,</span><span class="n">VEC</span><span class="p">,</span><span class="n">EE</span><span class="p">,</span><span class="n">ME</span><span class="p">,</span><span class="n">IR</span><span class="p">,</span><span class="n">DR</span><span class="p">,</span><span class="n">RI</span><span class="p">,</span><span class="n">LE</span><span class="o">&gt;</span><span class="w">  </span><span class="nl">CR</span><span class="p">:</span><span class="w"> </span><span class="mi">48002482</span><span class="w">  </span><span class="nl">XER</span><span class="p">:</span><span class="w"> </span><span class="mi">20000000</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.121215</span><span class="o">]</span><span class="w"> </span><span class="nl">CFAR</span><span class="p">:</span><span class="w"> </span><span class="n">c00000000004d454</span><span class="w"> </span><span class="nl">IRQMASK</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span>
<span class="o">[</span><span class="n">   10.121260</span><span class="o">]</span><span class="w"> </span><span class="nl">GPR00</span><span class="p">:</span><span class="w"> </span><span class="mi">00000000300051</span><span class="n">ec</span><span class="w"> </span><span class="n">c0000000fd7c3130</span><span class="w"> </span><span class="n">c000000001bcaf00</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span>
<span class="o">[</span><span class="n">   10.121368</span><span class="o">]</span><span class="w"> </span><span class="nl">GPR04</span><span class="p">:</span><span class="w"> </span><span class="mi">0000000048002482</span><span class="w"> </span><span class="n">c000000000058544</span><span class="w"> </span><span class="mi">9000000002009033</span><span class="w"> </span><span class="mi">0000000031</span><span class="n">c40060</span><span class="w"> </span>
<span class="o">[</span><span class="n">   10.121476</span><span class="o">]</span><span class="w"> </span><span class="nl">GPR08</span><span class="p">:</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span><span class="mi">0000000031</span><span class="n">c40060</span><span class="w"> </span><span class="n">c00000000004d46c</span><span class="w"> </span><span class="mi">9000000002001003</span><span class="w"> </span>
<span class="o">[</span><span class="n">   10.121584</span><span class="o">]</span><span class="w"> </span><span class="nl">GPR12</span><span class="p">:</span><span class="w"> </span><span class="mi">0000000031</span><span class="n">c40000</span><span class="w"> </span><span class="n">c000000001dd0000</span><span class="w"> </span><span class="n">c00000000000f560</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span>
<span class="o">[</span><span class="n">   10.121692</span><span class="o">]</span><span class="w"> </span><span class="nl">GPR16</span><span class="p">:</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span><span class="mi">0000000000000001</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span>
<span class="o">[</span><span class="n">   10.121800</span><span class="o">]</span><span class="w"> </span><span class="nl">GPR20</span><span class="p">:</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span>
<span class="o">[</span><span class="n">   10.121908</span><span class="o">]</span><span class="w"> </span><span class="nl">GPR24</span><span class="p">:</span><span class="w"> </span><span class="mi">0000000000000005</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span><span class="mi">0000000000000000</span><span class="w"> </span><span class="mi">0000000000000104</span><span class="w"> </span>
<span class="o">[</span><span class="n">   10.122016</span><span class="o">]</span><span class="w"> </span><span class="nl">GPR28</span><span class="p">:</span><span class="w"> </span><span class="mi">0000000000000002</span><span class="w"> </span><span class="mi">0000000000000004</span><span class="w"> </span><span class="mi">0000000000000086</span><span class="w"> </span><span class="n">c0000000fd9fba00</span><span class="w"> </span>
<span class="o">[</span><span class="n">   10.122150</span><span class="o">]</span><span class="w"> </span><span class="n">NIP</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000058544</span><span class="o">]</span><span class="w"> </span><span class="n">pnv_pci_cfg_write</span><span class="o">+</span><span class="mh">0x88</span><span class="o">/</span><span class="mh">0xa4</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122187</span><span class="o">]</span><span class="w"> </span><span class="n">LR</span><span class="w"> </span><span class="o">[</span><span class="n">c00000000004d458</span><span class="o">]</span><span class="w"> </span><span class="n">opal_return</span><span class="o">+</span><span class="mh">0x14</span><span class="o">/</span><span class="mh">0x48</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122204</span><span class="o">]</span><span class="w"> </span><span class="k">Call</span><span class="w"> </span><span class="nl">Trace</span><span class="p">:</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122251</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3130</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000058544</span><span class="o">]</span><span class="w"> </span><span class="n">pnv_pci_cfg_write</span><span class="o">+</span><span class="mh">0x88</span><span class="o">/</span><span class="mh">0xa4</span><span class="w"> </span><span class="p">(</span><span class="n">unreliable</span><span class="p">)</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122332</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3150</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000000585d0</span><span class="o">]</span><span class="w"> </span><span class="n">pnv_pci_write_config</span><span class="o">+</span><span class="mh">0x70</span><span class="o">/</span><span class="mh">0x9c</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122398</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c31a0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000234fec</span><span class="o">]</span><span class="w"> </span><span class="n">pci_bus_write_config_word</span><span class="o">+</span><span class="mh">0x74</span><span class="o">/</span><span class="mh">0x98</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122458</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c31f0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c00000000023764c</span><span class="o">]</span><span class="w"> </span><span class="n">__pci_read_base</span><span class="o">+</span><span class="mh">0x88</span><span class="o">/</span><span class="mh">0x3a4</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122518</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c32c0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000237a18</span><span class="o">]</span><span class="w"> </span><span class="n">pci_read_bases</span><span class="o">+</span><span class="mh">0xb0</span><span class="o">/</span><span class="mh">0xc8</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122605</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3300</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000002384bc</span><span class="o">]</span><span class="w"> </span><span class="n">pci_setup_device</span><span class="o">+</span><span class="mh">0x4f8</span><span class="o">/</span><span class="mh">0x5b0</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122670</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c33a0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000238d9c</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_single_device</span><span class="o">+</span><span class="mh">0x9c</span><span class="o">/</span><span class="mh">0xd4</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122729</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c33f0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000238e2c</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_slot</span><span class="o">+</span><span class="mh">0x58</span><span class="o">/</span><span class="mh">0xf4</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122796</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3430</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000239eb8</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_child_bus_extend</span><span class="o">+</span><span class="mh">0x40</span><span class="o">/</span><span class="mh">0x2a8</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122861</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c34a0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000239e34</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_bridge_extend</span><span class="o">+</span><span class="mh">0x4d4</span><span class="o">/</span><span class="mh">0x504</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122928</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3580</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c00000000023a0f8</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_child_bus_extend</span><span class="o">+</span><span class="mh">0x280</span><span class="o">/</span><span class="mh">0x2a8</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.122993</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c35f0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000239e34</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_bridge_extend</span><span class="o">+</span><span class="mh">0x4d4</span><span class="o">/</span><span class="mh">0x504</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123059</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c36d0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c00000000023a0f8</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_child_bus_extend</span><span class="o">+</span><span class="mh">0x280</span><span class="o">/</span><span class="mh">0x2a8</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123124</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3740</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000239e34</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_bridge_extend</span><span class="o">+</span><span class="mh">0x4d4</span><span class="o">/</span><span class="mh">0x504</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123191</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3820</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c00000000023a0f8</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_child_bus_extend</span><span class="o">+</span><span class="mh">0x280</span><span class="o">/</span><span class="mh">0x2a8</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123256</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3890</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000239b5c</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_bridge_extend</span><span class="o">+</span><span class="mh">0x1fc</span><span class="o">/</span><span class="mh">0x504</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123322</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3970</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c00000000023a064</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_child_bus_extend</span><span class="o">+</span><span class="mh">0x1ec</span><span class="o">/</span><span class="mh">0x2a8</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123388</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c39e0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000239b5c</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_bridge_extend</span><span class="o">+</span><span class="mh">0x1fc</span><span class="o">/</span><span class="mh">0x504</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123454</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3ac0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c00000000023a064</span><span class="o">]</span><span class="w"> </span><span class="n">pci_scan_child_bus_extend</span><span class="o">+</span><span class="mh">0x1ec</span><span class="o">/</span><span class="mh">0x2a8</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123516</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3b30</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000000030dcc</span><span class="o">]</span><span class="w"> </span><span class="n">pcibios_scan_phb</span><span class="o">+</span><span class="mh">0x134</span><span class="o">/</span><span class="mh">0x1f4</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123574</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3bd0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c00000000100a800</span><span class="o">]</span><span class="w"> </span><span class="n">pcibios_init</span><span class="o">+</span><span class="mh">0x9c</span><span class="o">/</span><span class="mh">0xbc</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123635</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3c50</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c00000000000f398</span><span class="o">]</span><span class="w"> </span><span class="n">do_one_initcall</span><span class="o">+</span><span class="mh">0x80</span><span class="o">/</span><span class="mh">0x15c</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123698</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3d10</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c000000001000e94</span><span class="o">]</span><span class="w"> </span><span class="n">kernel_init_freeable</span><span class="o">+</span><span class="mh">0x248</span><span class="o">/</span><span class="mh">0x24c</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123756</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3db0</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c00000000000f574</span><span class="o">]</span><span class="w"> </span><span class="n">kernel_init</span><span class="o">+</span><span class="mh">0x1c</span><span class="o">/</span><span class="mh">0x150</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123820</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c0000000fd7c3e20</span><span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="n">c00000000000b72c</span><span class="o">]</span><span class="w"> </span><span class="n">ret_from_kernel_thread</span><span class="o">+</span><span class="mh">0x5c</span><span class="o">/</span><span class="mh">0x70</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123854</span><span class="o">]</span><span class="w"> </span><span class="n">Instruction</span><span class="w"> </span><span class="k">dump</span><span class="err">:</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.123885</span><span class="o">]</span><span class="w"> </span><span class="mi">7</span><span class="n">d054378</span><span class="w"> </span><span class="mi">4</span><span class="n">bff56f5</span><span class="w"> </span><span class="mi">60000000</span><span class="w"> </span><span class="mi">38600000</span><span class="w"> </span><span class="mi">38210020</span><span class="w"> </span><span class="n">e8010010</span><span class="w"> </span><span class="mi">7</span><span class="n">c0803a6</span><span class="w"> </span><span class="mf">4e800020</span><span class="w"> </span>
<span class="o">[</span><span class="n">   10.124022</span><span class="o">]</span><span class="w"> </span><span class="n">e86a0018</span><span class="w"> </span><span class="mi">54</span><span class="n">c6043e</span><span class="w"> </span><span class="mi">7</span><span class="n">d054378</span><span class="w"> </span><span class="mi">4</span><span class="n">bff5731</span><span class="w"> </span><span class="o">&lt;</span><span class="mi">60000000</span><span class="o">&gt;</span><span class="w"> </span><span class="mi">4</span><span class="n">bffffd8</span><span class="w"> </span><span class="n">e86a0018</span><span class="w"> </span><span class="mi">7</span><span class="n">d054378</span><span class="w"> </span>
<span class="o">[</span><span class="n">   10.124180</span><span class="o">]</span><span class="w"> </span><span class="n">Kernel</span><span class="w"> </span><span class="n">panic</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">syncing</span><span class="p">:</span><span class="w"> </span><span class="n">Hard</span><span class="w"> </span><span class="n">LOCKUP</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.124232</span><span class="o">]</span><span class="w"> </span><span class="nl">CPU</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nl">PID</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nl">Comm</span><span class="p">:</span><span class="w"> </span><span class="n">swapper</span><span class="o">/</span><span class="mi">0</span><span class="w"> </span><span class="ow">Not</span><span class="w"> </span><span class="n">tainted</span><span class="w"> </span><span class="mf">5.0.5</span><span class="o">-</span><span class="n">openpower1</span><span class="w"> </span><span class="n">#2</span><span class="w"></span>
<span class="o">[</span><span class="n">   10.124251</span><span class="o">]</span><span class="w"> </span><span class="k">Call</span><span class="w"> </span><span class="nl">Trace</span><span class="p">:</span><span class="w"></span>
</code></pre></div>

<p>I wonder if I can submit that bug without someone throwing something at my desk.</p></div>
  		</article>
<div class="pagination">
    <a class="prev" href="https://sthbrx.github.io/index3.html">&larr; Older</a>

    <a class="next" href="https://sthbrx.github.io/index.html">Newer &rarr;</a>
  <br />
</div></div>
<aside class="sidebar">
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="https://sthbrx.github.io/blog/2023/04/05/detecting-rootless-docker/">Detecting rootless Docker</a>
      </li>
      <li class="post">
          <a href="https://sthbrx.github.io/blog/2023/04/04/dumb-bugs-the-pci-device-that-wasnt/">Dumb bugs: the PCI device that wasn't</a>
      </li>
      <li class="post">
          <a href="https://sthbrx.github.io/blog/2023/03/24/dumb-bugs-when-a-date-breaks-booting-the-kernel/">Dumb bugs: When a date breaks booting the kernel</a>
      </li>
      <li class="post">
          <a href="https://sthbrx.github.io/blog/2022/11/16/what-distro-options-are-there-for-power8-in-2022/">What distro options are there for POWER8 in 2022?</a>
      </li>
      <li class="post">
          <a href="https://sthbrx.github.io/blog/2022/10/26/power-kernel-hardening-features-in-linux-61/">Power kernel hardening features in Linux 6.1</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="https://sthbrx.github.io/category/development.html">Development</a></li>
        <li><a href="https://sthbrx.github.io/category/education.html">Education</a></li>
        <li><a href="https://sthbrx.github.io/category/openpower.html">OpenPOWER</a></li>
        <li><a href="https://sthbrx.github.io/category/performance.html">Performance</a></li>
        <li><a href="https://sthbrx.github.io/category/petitboot.html">Petitboot</a></li>
        <li><a href="https://sthbrx.github.io/category/snowpatch.html">snowpatch</a></li>
        <li><a href="https://sthbrx.github.io/category/virtualisation-and-emulation.html">Virtualisation and Emulation</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="https://sthbrx.github.io/tag/docker.html">Docker</a>,    <a href="https://sthbrx.github.io/tag/syzkaller.html">syzkaller</a>,    <a href="https://sthbrx.github.io/tag/linux.html">linux</a>,    <a href="https://sthbrx.github.io/tag/power8.html">power8</a>,    <a href="https://sthbrx.github.io/tag/distro.html">distro</a>,    <a href="https://sthbrx.github.io/tag/kernel.html">kernel</a>,    <a href="https://sthbrx.github.io/tag/hardening.html">hardening</a>,    <a href="https://sthbrx.github.io/tag/testing.html">testing</a>,    <a href="https://sthbrx.github.io/tag/conferences.html">conferences</a>,    <a href="https://sthbrx.github.io/tag/instruction-set-architecture.html">Instruction Set Architecture</a>,    <a href="https://sthbrx.github.io/tag/openpower.html">openpower</a>,    <a href="https://sthbrx.github.io/tag/firmware.html">firmware</a>,    <a href="https://sthbrx.github.io/tag/goodposts.html">goodposts</a>,    <a href="https://sthbrx.github.io/tag/realcontent.html">realcontent</a>,    <a href="https://sthbrx.github.io/tag/madposting.html">madposting</a>,    <a href="https://sthbrx.github.io/tag/op-test.html">op-test</a>,    <a href="https://sthbrx.github.io/tag/qemu.html">qemu</a>,    <a href="https://sthbrx.github.io/tag/pci.html">pci</a>,    <a href="https://sthbrx.github.io/tag/sparseposting.html">sparseposting</a>,    <a href="https://sthbrx.github.io/tag/petitboot.html">petitboot</a>,    <a href="https://sthbrx.github.io/tag/security.html">security</a>,    <a href="https://sthbrx.github.io/tag/vscode.html">vscode</a>,    <a href="https://sthbrx.github.io/tag/code.html">code</a>,    <a href="https://sthbrx.github.io/tag/openbmc.html">openbmc</a>,    <a href="https://sthbrx.github.io/tag/ipmi.html">ipmi</a>,    <a href="https://sthbrx.github.io/tag/opencapi.html">opencapi</a>,    <a href="https://sthbrx.github.io/tag/openpower-summit.html">openpower summit</a>,    <a href="https://sthbrx.github.io/tag/easyposts.html">easyposts</a>,    <a href="https://sthbrx.github.io/tag/linuxboot.html">linuxboot</a>,    <a href="https://sthbrx.github.io/tag/google.html">google</a>,    <a href="https://sthbrx.github.io/tag/intel.html">intel</a>,    <a href="https://sthbrx.github.io/tag/osfc.html">osfc</a>,    <a href="https://sthbrx.github.io/tag/shortposts.html">shortposts</a>,    <a href="https://sthbrx.github.io/tag/facebook.html">facebook</a>,    <a href="https://sthbrx.github.io/tag/performance.html">performance</a>,    <a href="https://sthbrx.github.io/tag/phoronix.html">phoronix</a>,    <a href="https://sthbrx.github.io/tag/benchmarks.html">benchmarks</a>,    <a href="https://sthbrx.github.io/tag/stupid-ideas.html">stupid ideas</a>,    <a href="https://sthbrx.github.io/tag/network.html">network</a>,    <a href="https://sthbrx.github.io/tag/power.html">power</a>,    <a href="https://sthbrx.github.io/tag/xdp.html">xdp</a>,    <a href="https://sthbrx.github.io/tag/networking.html">networking</a>,    <a href="https://sthbrx.github.io/tag/remoteposts.html">remoteposts</a>,    <a href="https://sthbrx.github.io/tag/ceph.html">ceph</a>,    <a href="https://sthbrx.github.io/tag/raid.html">raid</a>,    <a href="https://sthbrx.github.io/tag/storage.html">storage</a>,    <a href="https://sthbrx.github.io/tag/erasure.html">erasure</a>,    <a href="https://sthbrx.github.io/tag/lustre.html">lustre</a>,    <a href="https://sthbrx.github.io/tag/hpc.html">hpc</a>,    <a href="https://sthbrx.github.io/tag/nvlink.html">nvlink</a>,    <a href="https://sthbrx.github.io/tag/namd.html">namd</a>,    <a href="https://sthbrx.github.io/tag/cuda.html">cuda</a>,    <a href="https://sthbrx.github.io/tag/gpu.html">gpu</a>,    <a href="https://sthbrx.github.io/tag/minsky.html">minsky</a>,    <a href="https://sthbrx.github.io/tag/s822lc-for-hpc.html">S822LC for hpc</a>,    <a href="https://sthbrx.github.io/tag/debug.html">debug</a>,    <a href="https://sthbrx.github.io/tag/virtualisation.html">virtualisation</a>,    <a href="https://sthbrx.github.io/tag/dmesg.html">dmesg</a>,    <a href="https://sthbrx.github.io/tag/printk.html">printk</a>,    <a href="https://sthbrx.github.io/tag/boot.html">boot</a>,    <a href="https://sthbrx.github.io/tag/early.html">early</a>,    <a href="https://sthbrx.github.io/tag/error.html">error</a>,    <a href="https://sthbrx.github.io/tag/centos.html">centos</a>,    <a href="https://sthbrx.github.io/tag/centos7.html">centos7</a>,    <a href="https://sthbrx.github.io/tag/p8.html">p8</a>,    <a href="https://sthbrx.github.io/tag/bmc.html">bmc</a>,    <a href="https://sthbrx.github.io/tag/rhel.html">RHEL</a>,    <a href="https://sthbrx.github.io/tag/skiroot.html">skiroot</a>,    <a href="https://sthbrx.github.io/tag/devmapper.html">devmapper</a>,    <a href="https://sthbrx.github.io/tag/lvm.html">lvm</a>,    <a href="https://sthbrx.github.io/tag/cgroups.html">cgroups</a>,    <a href="https://sthbrx.github.io/tag/numa.html">numa</a>,    <a href="https://sthbrx.github.io/tag/development.html">Development</a>,    <a href="https://sthbrx.github.io/tag/netboot.html">netboot</a>,    <a href="https://sthbrx.github.io/tag/pxe.html">pxe</a>,    <a href="https://sthbrx.github.io/tag/education.html">Education</a>,    <a href="https://sthbrx.github.io/tag/work-experience.html">work experience</a>,    <a href="https://sthbrx.github.io/tag/asm.html">asm</a>,    <a href="https://sthbrx.github.io/tag/vdso.html">vdso</a>,    <a href="https://sthbrx.github.io/tag/snowpatch.html">snowpatch</a>,    <a href="https://sthbrx.github.io/tag/tools.html">tools</a>,    <a href="https://sthbrx.github.io/tag/intern.html">intern</a>,    <a href="https://sthbrx.github.io/tag/srop.html">SROP</a>,    <a href="https://sthbrx.github.io/tag/mitigation.html">mitigation</a>,    <a href="https://sthbrx.github.io/tag/double.html">double</a>,    <a href="https://sthbrx.github.io/tag/float.html">float</a>,    <a href="https://sthbrx.github.io/tag/hex.html">hex</a>,    <a href="https://sthbrx.github.io/tag/debugging.html">debugging</a>,    <a href="https://sthbrx.github.io/tag/skiboot.html">skiboot</a>,    <a href="https://sthbrx.github.io/tag/opal.html">OPAL</a>,    <a href="https://sthbrx.github.io/tag/fsp.html">FSP</a>,    <a href="https://sthbrx.github.io/tag/patches.html">patches</a>,    <a href="https://sthbrx.github.io/tag/based16.html">based16</a>,    <a href="https://sthbrx.github.io/tag/linux-gods.html">Linux Gods</a>,    <a href="https://sthbrx.github.io/tag/ozlabs.html">Ozlabs</a>,    <a href="https://sthbrx.github.io/tag/offtopic.html">offtopic</a>,    <a href="https://sthbrx.github.io/tag/autoboot.html">autoboot</a>,    <a href="https://sthbrx.github.io/tag/kexec.html">kexec</a>,    <a href="https://sthbrx.github.io/tag/aufs.html">aufs</a>,    <a href="https://sthbrx.github.io/tag/overlay.html">overlay</a>,    <a href="https://sthbrx.github.io/tag/php.html">php</a>,    <a href="https://sthbrx.github.io/tag/capi.html">capi</a>  </section>

  <section>
    <h1><a href="https://sthbrx.github.io/authors.html">Authors</a></h1>
    <ul id="authors_list">
        <li><a href="https://sthbrx.github.io/author/alastair-dsilva.html">Alastair D'Silva</a></li>
        <li><a href="https://sthbrx.github.io/author/andrew-donnellan.html">Andrew Donnellan</a></li>
        <li><a href="https://sthbrx.github.io/author/anton-blanchard.html">Anton Blanchard</a></li>
        <li><a href="https://sthbrx.github.io/author/benjamin-gray.html">Benjamin Gray</a></li>
        <li><a href="https://sthbrx.github.io/author/callum-scarvell.html">Callum Scarvell</a></li>
        <li><a href="https://sthbrx.github.io/author/cyril-bur.html">Cyril Bur</a></li>
        <li><a href="https://sthbrx.github.io/author/daniel-axtens.html">Daniel Axtens</a></li>
        <li><a href="https://sthbrx.github.io/author/daniel-black.html">Daniel Black</a></li>
        <li><a href="https://sthbrx.github.io/author/joel-stanley.html">Joel Stanley</a></li>
        <li><a href="https://sthbrx.github.io/author/nick-piggin.html">Nick Piggin</a></li>
        <li><a href="https://sthbrx.github.io/author/rashmica-gupta.html">Rashmica Gupta</a></li>
        <li><a href="https://sthbrx.github.io/author/rohan-mclure.html">Rohan McLure</a></li>
        <li><a href="https://sthbrx.github.io/author/russell-currey.html">Russell Currey</a></li>
        <li><a href="https://sthbrx.github.io/author/samuel-mendoza-jonas.html">Samuel Mendoza-Jonas</a></li>
        <li><a href="https://sthbrx.github.io/author/suraj-jitindar-singh.html">Suraj Jitindar Singh</a></li>
    </ul>
  </section>


    <section>
        <h1>Social</h1>
        <ul>
            <li><a href="https://sthbrx.github.io/rss.xml" type="application/rss+xml" rel="alternate">RSS</a></li>
            <li><a href="https://github.com/sthbrx/" target="_blank">GitHub</a></li>
            <li><a href="https://lists.ozlabs.org/listinfo/linuxppc-dev" target="_blank">linuxppc mailing list</a></li>
            <li><a href="https://lists.ozlabs.org/listinfo/skiboot" target="_blank">Skiboot mailing list</a></li>
        </ul>
    </section>
    <section>
        <h1>Blogroll</h1>
        <ul>
            <li><a href="http://ozlabs.org" target="_blank">OzLabs</a></li>
        </ul>
    </section>

    <section>
        <h1>Disclaimer</h1>
        <div>
This blog represents the views of the individual authors, and doesn't necessarily represent IBM's positions, strategies or opinions.        </div>
    </section>
</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2015&ndash;2023  OzLabs &mdash;
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
</body>
</html>